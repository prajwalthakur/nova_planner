# Nova Planner

Nova Planner is a ROS 2â€“based motion planning repository providing clean, example-driven implementations of sampling-based planning methods. It includes MPPI variants implemented in Python and JAX for fast prototyping and GPU-accelerated rollouts, alongside ongoing C++ implementations for real-time robotic systems. The repository also covers spline-based trajectory planning and multi-agent scenarios, with support for static, dynamic, and stochastic obstacles, and integrates with ROS 2 and Gazebo for simulation and visualization.

https://github.com/user-attachments/assets/10aa119e-c363-4215-aba8-9f231d30886d

(Will update the code base soon, for changes related to run mppi with dynamic obstacles)


## Highlights: 
- MPPI variants implemented in Python & JAX (C++ versions coming soon).
- Spline-based planners for single-agent and multi-agent systems.
- Planning with static, dynamic, and stochastic obstacles.
- ROS 2 & Gazebo integration for simulation and visualization.
- GPU-accelerated planning via JAX, running up to 20 Hz.
- Configurable parameters using YAML.
- Dockerized for reproducible environments.

## System Requirements:

- Tested on Ubuntu 22.04 with Ryzen 7 and RTX 3050

- CUDA-enabled GPU recommended; CPU-only mode supported (See notes at the end of the readme)

## Demo Videos:

`non_ros/example_video/`: Matplotlib-based simulation

`mppi_planner/example_video/`: ROS2 + Gazebo simulation

# Setup:
Assumes Cuda compatible hardware (check notes, if needs to run in cpu only)
## Docker Image Installation 
1. Install the Docker **Engine** [https://docs.docker.com/engine/install/](https://docs.docker.com/engine/install/)

Steps to create the Docker Image **mppi_ros2** (~10 min)
1. From root of the directory  run  `./scripts/build/build.sh`


## To run the docker Conatiner

Steps to create a docker container **mppi_docker** and will run it in a intractive mode

1. From root of the directory run `./scripts/deploy/devel.sh`

To launch multiple shells in docker container **mppi_docker**, run the following
1. run `docker exec -it mppi_docker bash` . This will attach the current terminal to the docker container mppi_docker. 

## Steps to build the package

make sure you are in ros2 workspace.
1. change the directory to `root/workspace/`
2. run `colcon build --symlink-install`
3. source `install/setup.bash`


## Steps to run the simulation in simple python and Matplotlib simulation
1. run `cd root/workspace/src/non_ros`
2. run `python3 main.py`

### Discription of files
1. `main.py` : Main script to launch mppi function and visualization script
2. `dyn_visualization.py`: Script to simulate dynamics and visualization
3. `mppi.py`: Main logic for the mppi planner
4. `config/sim_config.yaml`: Configurations related to simulations, dynamics and mppi-planner

#### Note:
1. Obstacles, start, and goal positions can be randomly generated by changing the seed in `sim_config.yaml`
2. Currently, the start and goal are deterministically set and can be modified in `main.get_start_goal`



https://github.com/user-attachments/assets/f546e0e0-457c-4443-befe-497f6370a613



# Steps to run the simulation in ROS2
After building the package, run the following launch files
1. run `ros2 launch mppi_planner mppi_planner.launch.py`  
this will run the simulation node spawn the obstacles
2. run `ros2 run mppi_planner mppi_planner_node` 
this will run the mppi_planning_node.py which contains the mppi planning logic

note: It may happen that launching Gazebo for the first time fails or some elements are not spawned. In that case, stop the process and relaunch it.

### Discription of files
```
|-- config
|   |-- mppi_rviz.rviz
|   |-- sim_config.yaml
|-- launch
|   |-- mppi_planner.launch.py
|-- mppi_planner
|   |-- mppi_class.py
|   |-- mppi_planner_node.py
|   `-- spawn_cylinder.py

```
1. `mppi_planner.launch.py` : Launch file to run the simulation node spawn the obstacles
2. `mppi_class.py`: Script to run the mppi-planning algorithm
3. `spawn_cylinder.py`: Script to spawn the obstacles, included in launch file
3. `mppi_rviz.rviz`: Rviz Configuration
4. `sim_config.yaml`: Configurations related to simulations, dynamics and mppi-planner

#### Note:
1. Obstacles, goal positions are hard coded in  `mppi_planner/config/sim_config.yaml`
2. MPPI is aware of the all the static obstacles



https://github.com/user-attachments/assets/8f08e8bb-debb-4088-8320-08d60748fde6



## TO DO:
- [] Add Unit Test Cases
- [] Implement MPPI in C++
- [] Utilize the local costmap to generate motion plans using MPPI.
- [] CVar MPPI for stochastic dynamics


## Note:
If the system doesnt support CUDA, then, in mppi_docker.Dockerfile:
- Change the base image from  `FROM  nvidia/cuda:12.6.0-cudnn-devel-ubuntu22.04` to `FROM ubuntu:22.04`
- Change the jax-cuda installation from `RUN pip3 install  "jax[cuda12]" ` to  `RUN pip3 install "jax[cpu]" -f https://storage.googleapis.com/jax-releases/jax_releases.html`
-In `deploy/devel.sh` change mode from `"gpu"` to `"cpu"`

## License
MIT License (Non-Commercial)







## Author
[Prajwal Thakur](https://github.com/prajwalthakur) 

